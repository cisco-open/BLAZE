From a6ebc77418ee89c17c88507f3f4fceda6f417e5b Mon Sep 17 00:00:00 2001
From: tudor-bytex <tviorean@cisco.com>
Date: Mon, 27 Mar 2023 13:21:39 +0300
Subject: [PATCH] Updated docs and requirements for opensourcing

---
 CONTRIBUTING.md                        |  13 +-
 README.md                              |  36 ++--
 aski/flask_servers/tests/conftest.py   |  18 ++
 aski/flask_servers/tests/test_basic.py |  18 ++
 check_code.sh                          |   3 +
 conv/README.md                         |   4 +-
 dev_requirements.txt                   | 233 -------------------------
 requirements.txt                       |  71 --------
 8 files changed, 73 insertions(+), 323 deletions(-)
 create mode 100644 check_code.sh
 delete mode 100644 dev_requirements.txt
 delete mode 100644 requirements.txt

diff --git a/CONTRIBUTING.md b/CONTRIBUTING.md
index 47b3795..4b9cb58 100644
--- a/CONTRIBUTING.md
+++ b/CONTRIBUTING.md
@@ -12,12 +12,13 @@ We use github to host code, to track issues and feature requests, as well as acc
 
 Pull requests are the best way to propose changes to the codebase. We actively welcome your pull requests:
 
-1. Fork the repo and create your branch from `main`.
-2. If you've added code that should be tested, add tests.
-3. If you've changed APIs, update the documentation.
-4. Ensure the test suite passes.
-5. Make sure your code lints.
-6. Issue that pull request!
+1. Fork the repo and proceed to set up the project locally following the steps detailed [here](./README.md#installation). Ensure you are cloning your fork and not the original repository.
+2. Create a new branch from `main` and implement your changes.
+3. If you've added code that should be tested, add tests.
+4. If you've changed APIs, update the documentation.
+5. If you've changed dependencies, update the `aski_env.yml` file accordingly.
+6. Ensure the test suite passes and the code lints by running `check_code.sh`.
+7. Issue that pull request!
 
 ## Any contributions you make will be under the Apache License, Version 2
 In short, when you submit code changes, your submissions are understood to be under the same [Apache License](LICENSE) that covers the project.
diff --git a/README.md b/README.md
index d6c02d4..886aa31 100644
--- a/README.md
+++ b/README.md
@@ -126,27 +126,33 @@ Run below command to build and run the environment
 
 ## Using the Conversational AI
 
-Build the conversational model with
+### Installation
 
-`python -m conv build`
+With `blaze/conv` as the working directory, proceed with the following steps.
 
-(This step may take about 15 minutes without a GPU)
+Create a virtual environment with Python 3.8.10
 
-And run the AI in the command line with
+```
+python3.8 -m venv .venv
+source .venv/bin/activate
+```
 
-`python -m conv converse`
+Install requirements in a virtual environment with 
 
-To run the webex bot server, start an ngrok tunnel with
+`pip install -r requirements.txt`
 
-`ngrok http 8080 --region=eu`
+Build the application with
 
-It is important that the region is *not* 'us'.
+`python -m conv build`
 
-Set the environment variables BOT_ACCESS_TOKEN (received when you register your bot) and WEBHOOK_URL (generated by ngrok) and change to the conv directory. Then run
+(This step may take about 15 minutes wihtout a GPU)
 
-`python webex_bot_server.py`
+And run in the commandline with
+
+`python -m conv converse`
 
-***Sources for training data***
+
+### Sources for training data
 - greet: food_ordering/greet/train.txt
 - exit: food_ordering/exit/train.txt
 - ask_question: manual data entry + mindmeld data augmentation
@@ -154,8 +160,14 @@ Set the environment variables BOT_ACCESS_TOKEN (received when you register your
 - upload_data: manual data entry + mindmeld data augmentation
 
 
+
 ## Instructions to install and run Supported Models, Knowledge Bases
 
+Installation of different models and knowledge bases is optional, depending on the needs of the user. Each must be installed
+and ran according to their own instructions in order to be used by BLAZE.
+
+Following are examples to install and run `Elasticsearch` and `ColBERT`.
+
 ***Installing Elasticsearch***
 
 Navigate to [Elasticsearch Installation](https://www.elastic.co/downloads/past-releases/elasticsearch-7-0-0) and 
@@ -173,7 +185,7 @@ Now, leave this terminal window open!
 
 ***Installing ColBERT***
 
-Clone the following [GitHub Repo (new-api branch)](https://github.com/stanford-futuredata/ColBERT/tree/new_api) into the `ColBERT` folder. 
+Clone the [ColBERT repository](https://github.com/stanford-futuredata/ColBERT/tree/new_api) in the `blaze` root directory. 
 
 > NOTE: There might be some issues with environments, these will be resolved by next commit! 
 
diff --git a/aski/flask_servers/tests/conftest.py b/aski/flask_servers/tests/conftest.py
index 4d6dc88..fb53f7b 100644
--- a/aski/flask_servers/tests/conftest.py
+++ b/aski/flask_servers/tests/conftest.py
@@ -1,3 +1,21 @@
+
+# Copyright 2022 Cisco Systems, Inc. and its affiliates
+#
+# Licensed under the Apache License, Version 2.0 (the "License");
+# you may not use this file except in compliance with the License.
+# You may obtain a copy of the License at
+#
+#      http://www.apache.org/licenses/LICENSE-2.0
+#
+# Unless required by applicable law or agreed to in writing, software
+# distributed under the License is distributed on an "AS IS" BASIS,
+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+# See the License for the specific language governing permissions and
+# limitations under the License.
+#
+# SPDX-License-Identifier: Apache-2.0
+
+
 import os
 import tempfile
 import yaml
diff --git a/aski/flask_servers/tests/test_basic.py b/aski/flask_servers/tests/test_basic.py
index 74fcff2..b67ae69 100644
--- a/aski/flask_servers/tests/test_basic.py
+++ b/aski/flask_servers/tests/test_basic.py
@@ -1,3 +1,21 @@
+
+# Copyright 2022 Cisco Systems, Inc. and its affiliates
+#
+# Licensed under the Apache License, Version 2.0 (the "License");
+# you may not use this file except in compliance with the License.
+# You may obtain a copy of the License at
+#
+#      http://www.apache.org/licenses/LICENSE-2.0
+#
+# Unless required by applicable law or agreed to in writing, software
+# distributed under the License is distributed on an "AS IS" BASIS,
+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+# See the License for the specific language governing permissions and
+# limitations under the License.
+#
+# SPDX-License-Identifier: Apache-2.0
+
+
 import pytest
 
 def get_select_model_options(client, app):
diff --git a/check_code.sh b/check_code.sh
new file mode 100644
index 0000000..dafdd73
--- /dev/null
+++ b/check_code.sh
@@ -0,0 +1,3 @@
+flake8 . --count --select=E9,F63,F7,F82 --show-source --statistics
+flake8 . --count --exit-zero --max-complexity=10 --max-line-length=127 --statistics
+pytest ./aski/flask_servers/tests
diff --git a/conv/README.md b/conv/README.md
index d84043c..111031c 100644
--- a/conv/README.md
+++ b/conv/README.md
@@ -2,6 +2,8 @@
 
 ### Installation
 
+With `blaze/conv` as the working directory, proceed with the following steps.
+
 Create a virtual environment with Python 3.8.10
 
 ```
@@ -24,7 +26,7 @@ And run in the commandline with
 `python -m conv converse`
 
 
-## Sources for training data
+### Sources for training data
 - greet: food_ordering/greet/train.txt
 - exit: food_ordering/exit/train.txt
 - ask_question: manual data entry + mindmeld data augmentation
diff --git a/dev_requirements.txt b/dev_requirements.txt
deleted file mode 100644
index 6a5557c..0000000
--- a/dev_requirements.txt
+++ /dev/null
@@ -1,233 +0,0 @@
-absl-py==1.2.0
-aiohttp==3.8.1
-aiosignal==1.2.0
-alabaster==0.7.12
-anyio==3.5.0
-appnope==0.1.3
-argcomplete==1.10.3
-argon2-cffi==21.3.0
-argon2-cffi-bindings==21.2.0
-astunparse==1.6.3
-async-timeout==4.0.2
-asynctest==0.13.0
-attrs==21.4.0
-Babel==2.9.1
-backcall==0.2.0
-backports.zoneinfo==0.2.1
-beautifulsoup4==4.8.2
-bert-score==0.3.11
-bitarray==2.4.1
-bleach==5.0.0
-bleu==0.3
-blis==0.7.7
-Brotli==1.0.9
-cachetools==5.2.0
-catalogue==2.0.7
-certifi==2022.12.07
-cffi==1.15.0
-chardet==3.0.4
-charset-normalizer==2.0.12
-click==8.0.4
-compressed-rtf==1.0.6
-cycler==0.11.0
-cymem==2.0.6
-dash==2.3.1
-dash-bootstrap-components==1.1.0
-dash-core-components==2.0.0
-dash-cytoscape==0.3.0
-dash-daq==0.5.0
-dash-extensions==0.0.71
-dash-html-components==2.0.0
-dash-table==5.0.0
-datasets==2.4.0
-debugpy==1.6.0
-decorator==5.1.1
-defusedxml==0.7.1
-dill==0.3.5.1
-docutils==0.17.1
-docx2txt==0.8
-ebcdic==1.1.1
-EbookLib==0.17.1
-EditorConfig==0.12.3
-efficiency==1.0
-elasticsearch==7.13.3
-entrypoints==0.4
-et-xmlfile==1.1.0
-evaluate==0.2.2
-extract-msg==0.28.7
-fastjsonschema==2.15.3
-fastrlock==0.8
-filelock==3.6.0
-Flask==2.1.1
-Flask-Caching==1.10.1
-Flask-Compress==1.11
-flatbuffers==1.12
-fonttools==4.36.0
-frozenlist==1.3.0
-fsspec==2022.7.1
-fuzzywuzzy==0.18.0
-gast==0.4.0
-gitdb==4.0.9
-GitPython==3.1.27
-google-auth==2.9.1
-google-auth-oauthlib==0.4.6
-google-pasta==0.2.0
-grpcio==1.47.0
-h5py==3.7.0
-huggingface-hub==0.8.1
-idna==3.3
-imagesize==1.4.1
-IMAPClient==2.1.0
-importlib-metadata==4.11.3
-importlib-resources==5.7.0
-ipykernel==6.13.0
-ipython==7.32.0
-ipython-genutils==0.2.0
-ipywidgets==7.7.0
-itsdangerous==2.1.2
-jedi==0.18.1
-Jinja2==3.1.1
-joblib==1.2.0
-jsbeautifier==1.10.2
-json5==0.9.6
-jsonschema==4.4.0
-jupyter==1.0.0
-jupyter-client==7.2.2
-jupyter-console==6.4.3
-jupyter-core==4.11.2
-jupyter-server==1.17.0
-jupyterlab==3.3.3
-jupyterlab-pygments==0.2.1
-jupyterlab-server==2.12.0
-jupyterlab-widgets==1.1.0
-keras==2.9.0
-Keras-Preprocessing==1.1.2
-kiwisolver==1.4.4
-langcodes==3.3.0
-libclang==14.0.6
-lumache==0.0.0
-lxml==4.9.1
-Markdown==3.4.1
-MarkupSafe==2.1.1
-matplotlib==3.5.3
-matplotlib-inline==0.1.3
-mistune==0.8.4
-more-itertools==8.12.0
-multidict==6.0.2
-multiprocess==0.70.13
-murmurhash==1.0.6
-nbclassic==0.3.7
-nbclient==0.6.0
-nbconvert==6.5.1
-nbformat==5.3.0
-nest-asyncio==1.5.5
-nltk==3.7
-notebook==6.4.10
-notebook-shim==0.1.0
-numpy
-oauthlib==3.2.1
-olefile==0.46
-openpyxl==3.0.9
-opt-einsum==3.3.0
-packaging==21.3
-pandas==1.3.5
-pandocfilters==1.5.0
-parso==0.8.3
-pathy==0.6.1
-pdfminer.six==20191110
-pexpect==4.8.0
-pickleshare==0.7.5
-Pillow==9.2.0
-plotly==5.7.0
-pockets==0.9.1
-preshed==3.0.6
-prometheus-client==0.14.1
-prompt-toolkit==3.0.29
-protobuf==3.19.5
-psutil==5.9.0
-ptyprocess==0.7.0
-pyarrow==8.0.0
-pyasn1==0.4.8
-pyasn1-modules==0.2.8
-pycparser==2.21
-pycryptodome==3.14.1
-pydantic==1.8.2
-Pygments==2.11.2
-pyparsing==3.0.8
-pyrsistent==0.18.1
-python-dateutil==2.8.2
-python-Levenshtein==0.12.2
-python-pptx==0.6.21
-pytz==2022.1
-pytz-deprecation-shim==0.1.0.post0
-PyYAML==6.0
-pyzmq==22.3.0
-qtconsole==5.3.0
-QtPy==2.0.1
-regex==2022.3.15
-requests==2.27.1
-requests-oauthlib==1.3.1
-responses==0.18.0
-rouge-score==0.1.2
-rsa==4.9
-sacremoses==0.0.49
-scipy==1.7.3
-Send2Trash==1.8.0
-six
-smart-open==5.2.1
-smmap==5.0.0
-sniffio==1.2.0
-snowballstemmer==2.2.0
-sortedcontainers==2.4.0
-soupsieve==2.3.2
-spacy==3.2.4
-spacy-legacy==3.0.9
-spacy-loggers==1.0.2
-SpeechRecognition==3.8.1
-Sphinx==5.0.2
-sphinx-rtd-theme==1.0.0
-sphinxcontrib-applehelp==1.0.2
-sphinxcontrib-devhelp==1.0.2
-sphinxcontrib-htmlhelp==2.0.0
-sphinxcontrib-jsmath==1.0.1
-sphinxcontrib-napoleon==0.7
-sphinxcontrib-qthelp==1.0.3
-sphinxcontrib-serializinghtml==1.1.5
-srsly==2.4.3
-tenacity==8.0.1
-tensorboard==2.9.1
-tensorboard-data-server==0.6.1
-tensorboard-plugin-wit==1.8.1
-tensorflow-estimator==2.9.0
-tensorflow-io-gcs-filesystem==0.26.0
-termcolor==1.1.0
-terminado==0.13.3
-textract==1.5.0
-thinc==8.0.15
-tinycss2==1.1.1
-tokenizers==0.11.1
-torch==1.13.0
-torchaudio==0.13.0
-torchvision==0.14.0
-tornado==6.1
-tqdm==4.64.0
-traitlets==5.1.1
-transformers==4.21.0
-typer==0.4.1
-typing-extensions
-tzdata==2022.1
-tzlocal==4.2
-ujson==5.4.0
-urllib3==1.26.9
-wasabi==0.9.1
-wcwidth==0.2.5
-webencodings==0.5.1
-websocket-client==1.3.2
-Werkzeug==2.1.1
-widgetsnbextension==3.6.0
-wrapt==1.14.1
-xlrd==1.2.0
-XlsxWriter==3.0.3
-xxhash==3.0.0
-yarl==1.8.1
-zipp==3.8.0
diff --git a/requirements.txt b/requirements.txt
deleted file mode 100644
index 584b1be..0000000
--- a/requirements.txt
+++ /dev/null
@@ -1,71 +0,0 @@
-aiohttp==3.8.1
-aiosignal==1.2.0
-async-timeout==4.0.2
-attrs==21.4.0
-blis==0.7.8
-catalogue==1.0.0
-certifi==2022.12.07
-charset-normalizer==2.1.0
-ciscosparkapi==0.10.1
-click==7.1.2
-click-log==0.1.8
-cymem==2.0.6
-distro==1.7.0
-elasticsearch==7.13.4
-filelock==3.7.1
-Flask==1.1.4
-Flask-Cors==3.0.10
-frozenlist==1.3.0
-future==0.18.2
-huggingface-hub==0.8.1
-idna==3.3
-immutables==0.18
-itsdangerous==1.1.0
-Jinja2==2.11.3
-joblib==1.2.0
-MarkupSafe==2.0.1
-marshmallow==3.7.1
-mindmeld==4.5.0
-multidict==6.0.2
-murmurhash==1.0.7
-mypy==0.971
-mypy-extensions==0.4.3
-nltk==3.7
-numpy==1.23.1
-packaging==21.3
-plac==1.1.3
-preshed==3.0.6
-py==1.11.0
-pycountry==22.3.5
-PyJWT==2.4.0
-pyparsing==3.0.9
-python-crfsuite==0.9.8
-python-dateutil==2.8.2
-pytorch-crf==0.7.2
-pytz==2022.1
-PyYAML==6.0
-regex==2022.7.9
-requests==2.28.1
-requests-toolbelt==0.9.1
-sacremoses==0.0.53
-scikit-learn==0.19.2
-scipy==1.8.1
-sentencepiece==0.1.91
-six==1.16.0
-sklearn-crfsuite==0.3.6
-spacy==2.3.7
-srsly==1.0.5
-tabulate==0.8.10
-thinc==7.4.5
-tokenizers==0.10.3
-tomli==2.0.1
-torch==1.7.1
-tqdm==4.64.0
-transformers==4.15.0
-twilio==7.12.0
-typing-extensions==4.3.0
-urllib3==1.26.10
-wasabi==0.9.1
-webexteamssdk==1.6.1
-Werkzeug==1.0.1
-yarl==1.7.2
-- 
2.37.1 (Apple Git-137.1)

